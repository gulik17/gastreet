{assign var=this value=$EditBaseTicketControl}
{formrestore id="form"}

{loadscript file='/js/fckeditor/jquery.FCKEditor.js' type='js'}
{loadscript file='/js/fckeditor/jquery.form.js' type='js'}

{loadscript file='/js/md5.js' type='js'}
{loadscript file='/js/caretaker.js' type='js'}

{loadscript file='/js/pages/adminkaeditbaseticket.js' type='js'}

<h2>{if $this.ticket}Редактирование {else}Создание {/if} билета</h2>
<form id="form" action="{alink do=savebaseticket}" method="post" onsubmit="ignoreSnapshot();">
    <input type="hidden" name="id" value="{$this.ticket->id}" />
    <input type="hidden" id="productIds" name="productIds" value="{$this.ticketProductsListString}" />
    <div class="row">
        <div class="col-md-6 form-group">
            <label>Статус:</label>
            <select class="form-control" name="status" id="status">
                {html_options options=$this.statusList selected=$this.ticket->status}
            </select>
        </div>
        <div class="col-md-6 form-group">
            <label>План:</label>
            <input class="form-control" type="text" name="plan" id="plan" value="{$this.ticket->plan}"/>
        </div>
        <div class="col-md-6 form-group">
            <label>Название:</label>
            <input class="form-control" type="text" name="name" id="name" value="{$this.ticket->name}"/>
        </div>
        <div class="col-md-6 form-group">
            <label>Название (Англ):</label>
            <input class="form-control" type="text" name="name_en" id="name" value="{$this.ticket->name_en}"/>
        </div>
        <div class="col-md-6 form-group">
            <label>Цена:</label>
            <input class="form-control" type="text" name="price" id="price" value="{$this.ticket->price}"/>
        </div>
        <div class="col-md-6 form-group">
            <label>Кол-во билетов:</label>
            <input class="form-control" type="text" name="maxCount" id="maxCount" value="{$this.ticket->maxCount}"/>
        </div>
    </div>
    <div class="form-inline">
      <div class="form-group">
        <label style="display:block">Дата и время начала мероприятия:</label>
        <input class="form-control" type="text" name="startDay" placeholder="дд" value="{if $this.startDay != null}{$this.startDay}{/if}" style="width: 44px;" /> . 
        <input class="form-control" type="text" name="startMonth" placeholder="мм" value="{if $this.startMonth != null}{$this.startMonth}{/if}" style="width: 44px;" /> . 
        <input class="form-control" type="text" name="startYear" placeholder="гггг" value="{if $this.startYear != null}{$this.startYear}{/if}" style="width: 60px;" /> в 
        <input class="form-control" type="text" name="startHours" value="{if $this.startHours != null}{$this.startHours}{else}00{/if}" style="width: 44px;" /> : 
        <input class="form-control" type="text" name="startMinutes" value="{if $this.startMinutes != null}{$this.startMinutes}{else}00{/if}" style="width: 44px;" />
       </div>
    </div>
    <div class="form-inline">
      <div class="form-group">
        <label style="display:block">Дата и время завершения мероприятия:</label>
        <input class="form-control" type="text" name="finishDay" placeholder="дд" value="{if $this.finishDay != null}{$this.finishDay}{/if}" style="width: 44px;" /> . 
        <input class="form-control" type="text" name="finishMonth" placeholder="мм" value="{if $this.finishMonth != null}{$this.finishMonth}{/if}" style="width: 44px;" /> . 
        <input class="form-control" type="text" name="finishYear" placeholder="гггг" value="{if $this.finishYear != null}{$this.finishYear}{/if}" style="width: 60px;" /> в 
        <input class="form-control" type="text" name="finishHours" value="{if $this.finishHours != null}{$this.finishHours}{else}23{/if}" style="width: 44px;" /> : 
        <input class="form-control" type="text" name="finishMinutes" value="{if $this.finishMinutes != null}{$this.finishMinutes}{else}59{/if}" style="width: 44px;" />
      </div>
    </div>
    <div class="row">
        <label style="display:block;margin-top:10px;padding-left: 15px;">В билет включены мастер-классы:</label>
        <div class="form-group col-md-6">
            <select class="form-control" id="products-left-select" name="choosenProducts" size="14">
                {if $this.ticketProductsList}
                    {foreach from=$this.ticketProductsList item=product}
                        {assign var=speakerid value=$product->speakerId}
                        <option value="{$product->id}">{$product->name} {$product->eventTsStart|dateformat:'d M в H:i'} ({$this.smArray.$speakerid})</option>
                    {/foreach}
                {/if}
            </select>
            <button class="btn btn-default" style="width: 100%;" id="product-remove-from-ticket">>></button>
        </div>
        <div class="form-group col-md-6">
            <select class="form-control" id="products-right-select" name="allProducts" size="14">
                {if $this.leftProductsList}
                    {foreach from=$this.leftProductsList item=product}
                        {assign var=speakerid value=$product->speakerId}
                        <option value="{$product->id}">{$product->name} {$product->eventTsStart|dateformat:'d M в H:i'} ({$this.smArray.$speakerid})</option>
                    {/foreach}
                {/if}
            </select>
            <button class="btn btn-default" style="width: 100%;" id="product-add-to-ticket"><<</button>
        </div>
        <div class="form-group col-md-12" id="anno-dl">
            <label id="anno-dt">Аннотация:</label>
            <div id="anno-dd"><textarea class="form-control" name="annotation" id="annotation">{$this.ticket->annotation}</textarea></div>
        </div>
        <div class="form-group col-md-12">
            <input class="btn btn-success" id="submitTicket" type="submit" value="Сохранить"/>
        </div>
    </div>
</form>
