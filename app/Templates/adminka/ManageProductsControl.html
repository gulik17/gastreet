{assign var=this value=$ManageProductsControl}
{formrestore id="products-filter"}

<h2>Мастер-классы, ужины</h2>

<a role="button" data-toggle="collapse" href="#collapseFilter" aria-expanded="false" aria-controls="collapseFilter"><h4>Фильтр для поиска <span class="caret"></span></h4></a>
<div class="collapse" id="collapseFilter">
    <form id="products-filter" method="post" action="" style="max-width: 400px;">
        <div class="well">
        <input type="hidden" name="show" value="manageproducts"/>
        <input type="hidden" name="isalive" value="1"/>
        <div class="products-users">
            <div class="form-group">
                <label>ID:</label>
                <input class="form-control" type="text" name="id" id="id" />
            </div>
            <div class="form-group">
                <label>Программа:</label>
                <select class="form-control" name="prog" id="prog">
                    <option value="0">-- ВСЕ --</option>
                    {html_options options=$this.amArray selected=$this.prog}
                </select>
            </div>
            <div class="form-group">
                <label>Локация:</label>
                <select class="form-control" name="place" id="place">
                    <option value="0">-- ВСЕ --</option>
                    {html_options options=$this.placeArray selected=$this.place}
                </select>
            </div>
            <div class="form-group">
                <label>Статус:</label>
                <select class="form-control" name="status" id="status">
                    {html_options options=$this.statusDesc}
                </select>
            </div>
            <div class="form-group">
                <input class="btn btn-info" type="submit" id="submit" value="Показать список отбора"/>
            </div>
        </div>
        </div>
    </form>
</div>

<div class="create">
    <a class="btn btn-primary" href="{alink show=editproduct}">Создать продукт</a>
</div>

{if $this.productsList}
    <br/>
    <table class="table table-striped table-bordered table-hover" cellspacing="0" cellpadding="0">
        <tr>
            <th>ID</th>
            <th>Название</th>
            <th>Программа</th>
            <th>Статус</th>
            <th>Цена</th>
            <th>Кол-во</th>
            <th>Осталось</th>
            <th>Время</th>
            <th>Актуализировано</th>
            <th>&nbsp;</th>
        </tr>
        {foreach item=product from=$this.productsList}
        {assign var=status value=$product->status}
        {assign var=areaid value=$product->areaId}
        {assign var=speakerid value=$product->speakerId}
        {assign var=speaker2id value=$product->speaker2Id}
        {assign var=speaker3id value=$product->speaker3Id}
        {assign var=speaker4id value=$product->speaker4Id}
        {assign var=speaker5id value=$product->speaker5Id}
        {assign var=speaker6id value=$product->speaker6Id}
        <tr class="{cycle values='color,'}">
            <td><a href="{alink show=editproduct id=$product->id}">{$product->id}</a></td>
            <td>
                <a href="{alink show=editproduct id=$product->id}">{$product->name|dbtexttohtml|strip_tags}</a>
                <p>{$this.smArray.$speakerid}{if $speaker2id}, {$this.smArray.$speaker2id}{/if}{if $speaker3id}, {$this.smArray.$speaker3id}{/if}{if $speaker4id}, {$this.smArray.$speaker4id}{/if}{if $speaker5id}, {$this.smArray.$speaker5id}{/if}{if $speaker6id}, {$this.smArray.$speaker6id}{/if}</p>
            </td>
            <td>{$this.amArray.$areaid}</td>
            <td>{$this.statusDesc.$status}</td>
            <td>{$product->price}</td>
            <td>{if $product->maxCount}{$product->maxCount}{else}-{/if}</td>
            <td>{if $product->leftCount}{$product->leftCount}{else}-{/if}</td>
            <td>{if $product->eventTsStart || $product->eventTsFinish}{$product->eventTsStart|dateformat:'d.m.Y, H:i'}{if $product->eventTsFinish} - {$product->eventTsFinish|dateformat:'d.m.Y, H:i'}{/if}{/if}</td>
            <td>{if $product->leftCountTs}{$product->leftCountTs|dateformat:'d.m.Y, в H:i'}{else}-{/if}</td>
            <td class="text-center"><a href="{alink do=admindelproduct id=$product->id}" onclick="return confirm('Вы уверены что хотите удалить данный продукт?');"><i class="fa fa-trash-o" title="Удалить" aria-hidden="true"></i></a></td>
        </tr>
        {/foreach}
    </table>
    {if $this.total}
        {pager total=$this.total per=$this.perPage}
    {/if}
{/if}
